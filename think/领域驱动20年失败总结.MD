### 大事记

2003 年，埃里克・埃文斯（Eric Evans）发表了具有里程碑意义的著作《领域驱动设计：软件核心复杂性应对之策》（Domain-Driven Design:
Tackling Complexity in the Heart of Software），正式提出了领域驱动设计的概念。

2006 年，吉米・尼尔森（Jimmy Nilsson）在他的著作《Applying Domain-Driven Design and Patterns: With Examples in C#
and.NET》中，将 DDD 和设计模式、重构等概念结合起来，进一步丰富了 DDD 的实践方法。

2007 年，格雷格・杨（Greg Young）提出了 CQRS（Command Query Responsibility Segregation）架构，将 DDD 的概念引入了架构设计，使得
DDD 可以更好地处理大型和复杂的系统。

2011 年，沃恩・弗农（Vaughn Vernon）在他的著作《Implementing Domain-Driven Design》中，进一步深化了 DDD 的实践方法，并提出了聚合设计的新方法。

### 落地实践方法

**与领域专家紧密合作**
你需要积极与业务领域的专家进行沟通和交流，他们对业务流程、规则和概念有着深入的理解。通过与他们合作，可以确保你的软件设计准确地反映了业务需求。
定期组织研讨会、访谈等活动，让领域专家参与到软件设计的过程中，共同探讨和解决问题。

**建立统一语言**
在团队中建立一种统一的业务语言，避免因术语不一致而导致的误解。这种统一语言应该基于领域专家的术语和概念，同时也易于开发人员理解和使用。
将统一语言贯穿于需求分析、设计、开发和测试的各个阶段，确保团队成员之间的沟通顺畅

**明确业务边界**
通过分析业务领域，确定不同的业务模块和功能边界。每个限界上下文代表一个独立的业务领域，具有明确的职责和边界。
避免限界上下文之间的过度耦合，确保每个上下文都可以独立地进行开发、测试和维护
**设计上下文映射**
确定不同限界上下文之间的关系，设计合理的上下文映射。上下文映射可以帮助你理解不同业务模块之间的交互方式，以及如何在软件设计中实现这些交互。
常见的上下文映射方式有共享内核、客户 / 供应商、遵奉者等，根据实际情况选择合适的映射方式。

**确定聚合根**
在每个限界上下文中，确定一个或多个聚合根。聚合根是聚合的核心实体，它负责维护聚合的一致性和完整性。
聚合根应该具有明确的业务含义，并且能够代表整个聚合的状态。

**设计聚合结构**
围绕聚合根设计聚合的结构，包括实体、值对象和领域服务等。实体具有唯一的标识，值对象则是不可变的、用于描述领域概念的对象。
确保聚合内部的对象之间具有高内聚性，同时聚合之间保持低耦合性。

### 实践经验总结

* 1，和领域专家紧密合作/建立领域模型


    大多数公司并不缺乏技术专家
    也并不缺乏业务专家。
    也并不缺乏让业务专家和技术专家一起紧密合作的空间和场所

    而是不知道使用什么样的方法，让他们在一起聊的时候，能聊到一起，而且能聊出一个炫目的结晶：领域模型
 
    领域驱动03年诞生到现在，这个基本问题没有解决。
    阿里中台折戟沉沙，是个典型的案例。他们有很好的技术，但是面对复杂业务系统，只有技术。
    行癫认为阿里需要更多的业务架构师：https://maimai.cn/article/detail?fid=1643165505&efid=GT7mnqHS9SKoZKDd5KeMiw
    但是他们不懂得怎么培养，不知道什么样的体系来解决这样的问题，采用的方法更多是找到牛人，然后让他人治。
    
    华为采用的是IPD的思路：流程驱动，业务驱动，用流程+业务串联市场、产品、研发……等部门；在IPD管理委员会中形成综合决策和执行机制。

    在宏观业务上，这套玩法并不是什么什么新鲜东西，传统行业就几百年就这么玩了————他们管这个叫做SOP。
    相对于IPD的笨重,SOP灵活性更强——他不介意你新事务不SOP，但是你最好以后必须标准化，流程化。
    IPD相对死板一点，华为的哲学是：先做标准，再做灵活。

    IPD能解决软件公司业务越来越复杂之后，各个部门信息不通，各自为战、形不成技术合力、项目规划缺乏前瞻性这种战略层面的问题。
    IPD不能解决软件架构腐化之后、技术架构制约组织架构、制约业务战略不能前进的问题。
    华为另有软件教练岗位，试图解决这个问题这些细节问题
              1，在具体软件的架构质量上，华为要差阿里一个档次，从阿里华为的软件的使用体验可以感受到
              2，但在架构规划立意上，华为要高阿里一个档次
                  他们数据库选型，编译器，操作系统等项目在
                  很多轮技术迭代以后可以看出优势：比如华为数据库选型方向是pg，然后在后面向量库热潮，ai热潮中就很能看到其选型优势
                  阿里很缺乏一套综合的管控机制，他们更倾向于让团队自由发挥。
              
    我个人认为
          我们日常所说的软件架构，更接近与阿里的软件架构师的工作————制造单体的高质量，接触软件本身的架构。和商业没有关系。
          华为的架构是管理架构和流程。
          在某种成都上，IPD成就了华为，也限制了华为成就非常优秀的软件架构。————从过去大大多数优秀软件统计看，非常依赖优秀架构师单体素质。

    那么，如何综合两者的优点呢？


参考：[架构师和业务专家通过什么样的工作模式可以产生领域模型](领域驱动思想的新发展.MD)    
 

* 2，建立统一语言~~
  
      1，建立统一语言的意义是什么？解决了什么问题？
      2，有没有其他解决方案？
      3，他和UML的区别在哪里？
  
      统一语言解决了技术专家和业务专家在一起的时候，聊不到一起，语言不通的问题。
      而UML是个更偏重技术侧的设计工具。
      统一语言名义上解决的是业务专家和技术专家在一起设计领域架构的时候，语言不同，名词含义不一样的问题
  
      但是呢，实践中———其实这倒是个小问题。更关键的的是他们在一起的时候话题如何聚焦
          1，怎么让他们聊到一起，而不是各聊各的话题
          2，他们中谁应该掌握话题的主导权，如何能够让对方聚焦，感兴趣，而不是不服，没兴趣
          3，话题应该如何和业务目标，和战略，和模型聚焦
       否则，技术专家在关心高并发，分布式；
       业务专家在担心客户、分润方式、客户交互……
       项目经理在”和稀泥“：135架构师讲，246业务专家讲
       
       实践中发现 
       也并不是无需关注聚焦他们的兴趣和精力，机械化定义一套双方必须理解的名词定义能够解决沟通问题。
       比如某宇宙大行集中300个管培生，投入巨资找国内外架构专家培训，整理出16w字段的精确定义。
       或者某金融行业大厂，对于涉足行业的每个字段都给出标准词典定义，要求日常生产开发过程中使用。
       这些，有一定的作用，但作用远远要小于让他们在一起，找一个纸板，描述自己的需求和问题，直接发现gap，直接沟通。
       ————只不过这样的沟通，依然碎片化——不足以形成领域模型。
      
      相对而言，仅就目的和效果而言，敏捷沟通是最合适的。
      词典只是中间产物，而不是最终产物。————没有最终产物（领域模型），中间产物没有意义，很容易消失或者无效。


参考：[架构师和业务专家通过什么样的工作模式可以产生领域模型](领域驱动思想的新发展.MD)

* 3，明确业务边界

划定边界，表面上看是个技术问题，实际上是个组织架构问题。

从技术上讲，划定边界的原则和标准从计算机诞生依赖，并没有发生变化，变化的只是技术手段，

* 结构化语言（静态链接库/动态链接库）
* 面向对象语言（库、包）
* 微服务架构（应用）

当然，不同的技术手段，也有很大的差异————虽然这种差异在技术上并不大，但在组织架构上并不一定。

比如
    
    业务系统业务流程非常长，复杂，多变。需要一个积木化的流程编排组件，满足以下需求
    1，复杂业务拆分为标准积木块
    2，可组装为复杂流程，满足可编排、最终一致、高并发、可插拔、可运维等要求————所以要求组件形态是一个sdk包。
    而集团架构部只愿意承接微服务形态的流程编排需求。

再举一个例子
  
    2005~2010年SOA化浪潮期间，几年的时间，中国很多互联网的应用数量从几个膨胀到几千个。
    15~现在，想要降低百分之几十都很难，典型如阿里，中台项目折戟沉沙。

我认为这背后的根本原因除了行癫说的”缺乏业务架构师“之外，比较关键的是组织架构问题。

    SOA譬如藩镇、分封，可以让一个组织迸发出最大的活力；在机会比较多的时候，容易脱颖而出；但也容易在困局之中，彼此以邻为壑，陷入内斗。
    一个组织，如想要长久，在任何情况下过得去，不能是一个极端的架构。如果某个时间极端，在另外一个时间就必须纠正。
    那么所谓中台，本质就是削藩/罢相夺权。

    历史上所有削藩/罢相夺权，成功的关键有两条
    1，有强大的同盟，可以是宦官、可以是官僚体系、可以是中央军
    2，给对手开出可以接受的退路、比如宋朝给对方优厚的待遇、或者如汉武帝推恩子孙

    如果，既不能让问题的根源满意的退休。也没有强大的同盟军。那么无论做什么，可能都是徒劳。

    在业务架构师日常的工作中，如果想用A架构方案替换B架构方案。而B架构方案涉及公司现有组织架构BU.B的利益和协作的话，比较可行的做法是
    1，把架构方案A作为BU.B的关键考核目标，让他自己革自己的命。
    2，指派S部门，作为BU.B的协助方，提供目标规划、技术指导、进度管理方面的支持）（S部门一般包括构师，部门负责人，PMO等）
    基本不可行的做法是
    1，A架构方案并行，替换B（研发问题并不大，切换和替代过程并不是个技术问题，涉及到客户、稳定性，监管责任，部门利益、团队协作等）

    为什么AB替换不可行。
    1，A就是B，B就是A。这样的替换没有意义。只是解决了短期的问题
    2，AB之间斗争大于协作，内耗过大，收益并不大，甚至可能反噬。

    做个题
    CTO要求架构师A协作B部门，改进B部门的架构，改善技术债，提升稳定性。
    架构师有以下几个可选做法
    A，要求B部门提供方案，通过架构评审，推动B部门执行。结果和架构无关。
    B，要求B部门提供方案，通过架构评审，推动B部门执行，提供技术支持，结果和架构无关。
    C，给B部门提供确切的方案，通过B部门的评审，参与动B部门执行。结果和架构师&部门都有关。
    D，给B部门提供确切的方案，通过B部门的评审，推动B部门执行。结果和架构师无关。

    正确的做法是B。
    A的做法是技术架构的做法，往往是改了几个技术组件的皮毛问题，无法解决业务系统系统架构深层次的问题。
    CD的做法容易产生凭空的架构方案，在细节上很难执行；形成完备方案过于耗时，也不容易调动B的积极性。
    C的的做法边界不清晰，容易产生摘桃子猜疑链；B作为最大风险承担方和工程实施方，顾虑比较多；积极性不够。A即使有心，也不一定能够推得动（要随缘，看B的品性）
    ————”这些我都试验很多次了                       ————————-隋卞“

    而B的做法，虽然可行，对架构师A的要求比较高
    1，他需要在不了解业务细节的情况下，可以综合评判B部门的架构设计质量。包含业务架构，技术架构，数据架构。
    作为一个个人不能是一个普遍的要求
    2，A如果是一个组织（架构委员会），效率会过低；而且级别过高，B部门不一定能”驱动“的了，形成真正有效的技术支持。
    3，A如果是一个组织，还容易形成众口一词，难以定论的情况，B部门如果有心做事，能不上会就尽量不上会；如果无心做事，能上会尽量上会。

    过去封建社会下，对这个矛盾的解决方案是：
    1，六部、藩镇不再各自事务各自专权，而必须和高层机构形成流程，分离决策和执行权、监督权。
    2，组织一个尽量精简的机构，遴选实操能力尽量高的人（学历高的在翰林），给的级别尽量低、给的待遇尽量高（例如军机处；枢密院）

    国内很多公司的架构师委员会呢，因为形式上是虚设机构，级别不够好，所以服务还是能够服务的。但是也存在几个问题
    1，说了不算，各个部门想用就用，不想用就不用。不能形成有效架构管理机制
    2，组织结构，组成成分太单一，技术架构为主；为了技术而技术；太强调他们的作用，反而不一定对业务和架构目标产生太多正向的效果。
    3，组成成分复杂的、往往沦为业务驱动的工具和渠道；和复杂项目的管理性质的委员会并没有什么本质区别。没有突出架构委员会应该负的职责————其关键原因
      是无法清晰、有效定义架构委员会的产出物。
      如果只是文档，往往沦为无用的机构。
      如果是进度，是管理委员会应该做的。
      如果是组织决策，是管理机构应该做的。
      如果是可靠性，一致性，是技术架构应该做的。
      如果是产品形态，是产品应该做的。

    回到架构两个字的本意：控制复杂性，提供确定性和可能性空间。
    我认为并不是没有架构业务就不能发展了，而是复杂一定程度上，需要提供一种更精简、更高效、更具备业务变革潜力的设计。
    在操作系统上，是微内核。
    在公司结构上，对软件公司而言，组织结构必然耦合业务架构，必然受制于软件架构。
    如何解耦？
    架构师委员会，是这样一个解耦机构。一方面，他提供的架构决策，最终目标是微内核的组织架构；落地层面，是软件架构。两者是1而2，2而1的事情。
    所以，他最小层面，是
    1，把一个复杂软件领域的MVP模型先跑起来。
    2，用这个MVP可插拔的支持这个复杂领域的所有业务
    3，把这个模式复制到其他几个领域反复玩几遍，掌握其中各种问题的解决方案
    4，然后再考虑公司层面的组织架构+业务架构+软件架构的综合治理。

    这个做不到，理解不了如何玩，，就玩IPD，TOGAF……数字化变革。无非赶潮流玩弄各种技术工具的boy而已。
  

参考：[架构设计的基本原则](领域驱动思想的新发展.MD)

* 4，设计上下文映射



    

* 5，确定聚合根

          信息决定架构，聚合根是业务分析的抓手。
                        譬如，一颗大树，枝繁叶茂。但无论多么繁茂，每一个毛细细节必然通向根。
                        在软件中，同样有这样的关系：某个数据对象，可以映射这个软件的架构形状。
          所以，找到聚合根，分析清楚了聚合根的数据要素和词典，就抓住了整个复杂软件的关键。
                        它同时意味着
                         1，逻辑上存在一个最合理的架构形状和结构。
                         2，架构分析过程，不再容易过度设计，而变得更有目的和针对性

  * 6，防腐层设计


    
      深入人心。
        甚至，我能看到没有任何领域设计的系统中，所有外部调用都有Proxy模式封装。


* 7，值对象/实体对象
    
    值对象有不同的理解
    
    JDK理解的值对象：是不可变对象。

    DDD理解的值得对象：是变化的抽象。

    这两个背后的思想其实是统一的：化变化为不变。
            
 
    这两个抽象背后是软件对整个世界的抽象
    有限性：code
    无限性：id