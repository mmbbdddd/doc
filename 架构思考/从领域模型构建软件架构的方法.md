### 概述

领域驱动理论落地大致遵循这样一个流程

流程：领域学习》事件风暴》领域驱动代码模型》核心代码设计


### 领域学习

在1960年的时候，《人月神话》已经断定：阻碍软件设计的最大困难是构建“概念完整性”， 但截止到2003年领域驱动理论
诞生之前，没有一个架构理论解决了这个根本问题。

    尽管有很多架构方法论，比如《Unix设计哲学》《Jee设计哲学》，KISS，SOILD，瀑布，TOGAF.....然而他们要么是
    在停留在意图表达阶段、要么只是在操作、步骤上。。。


除了概念完整性外，在设计和实现上，也存在更大的困难


    软件的根本困难……软件的本质是一些彼此耦合的、容易变化的，概念和概念之间的关系。（参考三体、混沌等数学理论）

大概在2000年前后五年，这几个难点分别被几个不同的理论和实践“默默攻克“

    概念完整性：聚合根
    软件变化的抽象：JEE架构（容器、组件体系）
    代码设计最佳实践：实体、值对象、聚合、仓储工厂、隔离层

### 聚合根

聚合根解决了这个问题。他的原理相当简单：信息决定架构

    如同大树的每个枝叶必然和根相连获取养分；软件的架构是一颗逻辑树、树的形状和输入信息的结构密切相关。 

例如一个支付系统的聚合根可能是这样的。

    pay_trade_order
    卖家：mall_id;ID
    卖家类型：普通小商家，VIP付费小商家，大客户、VIP付费大客户.....:枚举值对象
    买家ID：user_id:ID
    买家类型：穷鬼/穷人VIP/有钱人/有钱人且舍得花钱的VIP。。。。。。:枚举值对象
    支付金额：amount：数据类型
    支付渠道：alipay，weixinPay，abc，psbc，.....：枚举值对象

有意思是《领域驱动》这一突破性的理论认识，然而他在书中表达的非常含糊。我猜测这可能和他开销售公司有关系。

#### 获取聚合根的方法
* 事件风暴
* 数据库

#### 聚合根架构设计的最佳实践
* 流程架构设计
  -  硬编码流程
  -  Pipeline
  -  流程编排
  -  工作流
* 业务词典设计
  -  ER模型
  -  插件架构
  -  对象图
  -  模块结构设计


### 代码设计最佳实践

领域驱动在理论上的最大意义可能并不是他解决了“概念完整性”。而是提出了一套设计代码的最佳实践。即：事件对象、实体、值对象、聚合、上下文、仓储对象、隔离层.

参见[《领域驱动：代码角色模型》](./领域驱动：代码角色模型.MD)

在大多数遗留系统中，业务模式是固定的，很多员工都是浸淫10多年的老员工，概念完整性是存在的。

制约系统架构质量的是架构能力和代码落地能力

1，大多数开发不知道什么是好的架构

     他们只是在拼命的学习、使用各种炫酷的技术、框架、组件。
     只是觉得他们切切实实的解决了实在的问题。
     而并不清楚这些东西到底对整体架构、对未来的业务发展、对未来的稳定性等存在什么样的问题。

     有些人意识到了这些问题，反过来又极端保守。限制了系统的技术能力，只能被动的迎合业务。
2，大多数开发不知道什么是好的代码

    不是名气大的、star多的、公司大的
    DDD的代码角色模型是切切实实从理论到实践上都给出了最佳实践。


3，欠缺工程方法和实践

    网上很多人看了梅西和乔丹的视频以后纷纷评价：我眼睛已经学会了。

    从懂到能实践、到能灵活根据各种实际场景灵活运用，需要大量的训练。

    而从一个人，到一个团队，更是需要系统性的工程方法。

    我个人总结的一些方法

    1，流程驱动
    2，事件风暴
    3，业务编排
    4，ER优先
    5，三离四化
    6，注意胶水层设计
      


 
